<hr>
<p>title: iOS原理-renderLoop<br>date: 2021-11-01 13:19:53<br>tags: [iOS原理,iOS面试题,iOS卡顿]</p>
<hr>
<p>字节的面试中，问了一道renderLoop的问题。我当时一脸懵逼😳，然后又问了UIView的渲染过程。当时没有回答好，准备好好总结一下。</p>
<h2 id="Explore-UI-animation-hitches-and-the-render-loop"><a href="#Explore-UI-animation-hitches-and-the-render-loop" class="headerlink" title="Explore UI animation hitches and the render loop"></a>Explore UI animation hitches and the render loop</h2><h3 id="卡顿（hitch）是什么？"><a href="#卡顿（hitch）是什么？" class="headerlink" title="卡顿（hitch）是什么？"></a>卡顿（hitch）是什么？</h3><p>A hitch is any time a frame appears on screen later than expected.<br>任何时候屏幕上出现晚于预计的帧都属于卡顿。</p>
<h3 id="the-Render-loop"><a href="#the-Render-loop" class="headerlink" title="the Render loop"></a>the Render loop</h3><p>The Render Loop is a continuous process by which touch events are handed to an app, and then changes to the UI are sent to the operating system where the frame is finalized.It’s a loop, and it happens at the device’s refresh rate.</p>
<p>渲染循环是一个连续性的过程。通过触碰事件传送给app，然后转化到用户界面，向操作系统传送。最终呈现给用户，这就是循环，随着设备的刷新率发生。</p>
<p><img src="/theRenderLoop1.png" alt="the Render loop "></p>
<p>整个渲染循环由五个阶段组成:</p>
<ul>
<li>1.事件阶段(Event)</li>
<li>2.提交阶段（Commit）</li>
<li>3.渲染准备(Render prepare)</li>
<li>4.渲染执行(Render execute)</li>
<li>5.展示阶段(Display)</li>
</ul>
<p><img src="/theRenderLoop.png" alt="the Render loop 阶段"></p>
<h4 id="事件阶段（Event"><a href="#事件阶段（Event" class="headerlink" title="事件阶段（Event)"></a>事件阶段（Event)</h4><p>在这个阶段，App处理触碰事件或者Timer等其他事件，决定用户界面是否需要变化。</p>
<h3 id="卡顿的类型-the-type-hitchs）"><a href="#卡顿的类型-the-type-hitchs）" class="headerlink" title="卡顿的类型(the type hitchs）"></a>卡顿的类型(the type hitchs）</h3><p>1.提交卡顿(commit hitch)<br>2.渲染卡顿(render hitch)</p>
<p><img src="/theTypeHitchs.png" alt="the type hitchs"></p>
<h3 id="测量卡顿时间-measuring-hitch-time"><a href="#测量卡顿时间-measuring-hitch-time" class="headerlink" title="测量卡顿时间 (measuring hitch time)"></a>测量卡顿时间 (measuring hitch time)</h3><h2 id="提交阶段的卡顿"><a href="#提交阶段的卡顿" class="headerlink" title="提交阶段的卡顿"></a>提交阶段的卡顿</h2><h3 id="iOS离屏渲染"><a href="#iOS离屏渲染" class="headerlink" title="iOS离屏渲染"></a>iOS离屏渲染</h3><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://developer.apple.com/videos/play/tech-talks/10855">Explore UI animation hitches and the render loop</a></p>
<p><a href="https://developer.apple.com/videos/play/tech-talks/10856">Find and fix hitches in the commit phase</a></p>
<p><a href="https://developer.apple.com/videos/play/tech-talks/10857">Demystify and eliminate hitches in the render phase</a></p>
